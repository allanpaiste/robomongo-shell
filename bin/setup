#!/usr/bin/env bash

FILE_PATH="$(pwd)/${BASH_SOURCE[0]}"
BIN_DIR="$(cd "$(dirname "${FILE_PATH}")" && pwd)"

deactivate 2>/dev/null

source ${BIN_DIR}/common/config
source ${BIN_DIR}/common/setup ${1}

echo "Bin dir: ${BIN_DIR}"
echo "Project dir: ${PROJECT_DIR}"

if ! brew info scons &>/dev/null ; then
    sudo chown -R $(whoami) /usr/local/share/man/man5
    brew install scons
fi

curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py
python get-pip.py

if which pip2.7 &>/dev/null ; then
    pip2.7 uninstall virtualenv
    pip2.7 install virtualenv
else
    pip uninstall virtualenv
    pip install virtualenv
fi

virtualenv --python=python2.7 venv

source venv/bin/activate

pipenv install

deactivate
